# 第12章 継承の取り扱い

- 特性を継承階層に沿って上下に移動させたいことはよくある。
    - 「**メソッドの引き上げ**」、「**フィールドの引き上げ**」、「**コンストラクタ本体の引き上げ**」、「**メソッドの押し下げ**」、「**フィールドの押し下げ**」でこれを扱う。
- 継承階層にクラスを加えたり取り除いたりしたいこともある。
    - 「**スーパークラスの抽出**」、「**サブクラスの削除**」、「**クラス階層の平坦化**」で可能となる。
- サブクラスを追加することで、値によって振る舞いを変えさせるためのフィールドを置き換えることもある。
    - 「**サブクラスによるタイプコードの置き換え**」で行う。
- 継承は強力なツールだが、ふさわしくない場所で使っていたり、利用場所がふさわしくなくなったりすることがある。
    - 「**委譲によるサブクラスの置き換え**」、あるいは「**委譲によるスーパークラスの置き換え**」を適用して、継承を委譲に変える。

## メソッドの引き上げ
逆：メソッドの押し下げ

### 動機
- 重複するコードを取り除くことは重要である。重複は常に、一方の変更がもう一方に反映されないかもしれないというリスクを意味する。そして、重複を見つけるのは 一般に困難である。
- 「メソッドの引き上げ」を適用する最も単純なケースは、二つ以上のメソッドが同じ内容を持ち、コピー&ペーストが行われたことが暗示される場合である。
- 「メソッドの引き上げ」は、他のステップの後で行うことがよくある。
    - 異なるクラスの二つのメソッドをパラメータ化すれば同じメソッドになる場合、最短のステップは、それぞれに「パラメータによる関数の統合（第11章）」を適用してから「メソッドの引き上げ」をすることである。
- 「メソッドの引き上げ」で最も厄介な状況は、サブクラスにあってスーパークラスにない特性をメソッド本体が参照している場合である。その場合は、先にそれらの要素に対して「フィールドの引き上げ（第12章）」や「メソッドの引き上げ 」を適用する必要がある。

### 手順
- 引き上げたいメソッドが同一であるか精査する。
- メソッド本体内のすべてのメソッド呼び出しとフィールドの参照が、スーパークラスから呼び出し可能な特性を参照していることを確認する。
- メソッドのシグネチャ（メソッド名とほぼ同義）が異なる場合は、「**関数宣言の変更（第6章）**」を適用して、スーパークラスで使用したいシグネチャに変更する。
- スーパークラスに新しいメソッドを作成する。いずれかのメソッド本体をそこにコピーする。
- 静的コード解析を行う。
- 一つのサブクラスのメソッドを削除する。
- テストする。
- サブクラスのメソッドがすべてなくなるまで、削除を繰り返す。
